## 页面间的相互通讯（操作）
### window.open
> ### **window.open(url [, name, features, replace])**  
> url: 要打开页面的路径（相对路径or绝对路径）  
> name: 给打开的子页面赋值window.name  
> features: 为打开新窗口的配置项（宽度、高度等）  
> replace: 为true的话则替换浏览历史中的当前条目(返回回不去)，默认为false,创建新条目
* name  
```javascript
//test1在新标签页打开一个窗口，并进入www.baidu.com网站。url可以为相对路径或绝对路径
window.open('http://www.baidu.com');
//test2在新标签页打开一个窗口，并进入www.baidu.com网站。该页面window.name为‘我想你’
window.open('http://www.baidu.com', '我想你');
//test3在新标签页打开一个窗口，并进入www.baidu.com网站。该页面window.name为‘我想你’。2s后该页面继续跳转到www.google.com
window.open('http://www.baidu.com', '我想你');
window.setTimeout(function() {
  window.open('http://www.google.com', '我想你');
}, 2000);
//so当父页面open一个带有name的url的时候，当存在该name的页面则这个页面刷新到新的路径，当不存在该name的页面则新打开一个标签页，over。
```
* features  
上一张MDN的图，这只是一部分。
![](./image/window.open.gif)
* 页面之间的相互通讯（控制）
```javascript
//test这次我们吧打开的页面赋值到变量baidu，如果打印出来该值是一个整数、null（打开受阻，比如“Firefox阻止了此网站弹出一个窗口”）
var baidu = window.open('http://www.baidu.com', '我想你');
baidu.document.body.innerHTML = '';
baidu.close();
baidu.document.getElementById('xxx');
...
//也可以在子页面操作父页面
window.opener.document...
```
### iframe
用到的API
> * window.top 整个嵌套页面组的最顶层页面
> * window.self 当前页面
> * window.parent 当前页面的上一层页面
### postMessage
> 功能实现来自于HTML5新特性web worders
* 父传子
```html
//in test.html
<!DOCTYPE html>
<html>
<head>
    <title>postMessage</title>
    <script type="text/javascript">
    function sendMsg(){
        //通过postMessage向子窗口发送数据
        document.getElementById('child').contentWindow.postMessage(document.getElementById('message').value,'/');
    }
    </script>
</head>
<body>
    <iframe src="parent.html" id="child"></iframe>
    <input type="text" id="message">
    <input type="button" value="sent msg" onclick="sendMsg()">
</body>
</html>
```
```html
// in parent.html
 <html> 
 <head> 
     <title>postMessage child page</title> 
     <script type="text/JavaScript"> 
         //event 参数中有data属性，就是父窗口发来的数据
         window.addEventListener('message', function(event) {
             //显示数据
             document.body.innerHTML += event.data;
         }, false);
     </script> 
 </head> 
 <body> 
     
 </body> 
 </html>
```
* 子传父
```html
<!-- in test.html -->
<!DOCTYPE html>
<html>
<body onload="load()">
    <iframe src="parent.html"></iframe>
    <script type="text/javascript">
        function load() {
            window.addEventListener('message', function(event) {
                document.getElementById('text').innerHTML += event.data;
            }, false);
        }
    </script>
    <p id="text">yes</p>
</body>
</html>
```
```html
<!-- in parent.html -->
<!DOCTYPE html>
<html>
<head>
    <script type="text/javascript">
        function load() {
            parent.postMessage('子窗口往父窗口传递数据','/');
        }
    </script>
</head>
<body onload='load()'>
    aaa
</body>
</html>
```
[参考](https://www.cnblogs.com/codetker/p/4684240.html#topics)