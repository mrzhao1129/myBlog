# 浏览器的缓存方案（笔记）
浏览器相关资源的缓存是通过头(header)进行配置的，下边列一些常用到的关于缓存的头配置项。
## HTTP/1.0  
`Expires: Fri, 02 Jan 2000 00:00:00 GMT`
## HTTP/1.1
|Header|验证器|req/res|描述|
|--|--|--|--|
|`Cache-Control: max-age=31536000`|弱|Response|最大缓存时间；单位s；最大值31536000（一年）；|
|`Cache-Control: no-cache`|强|Response||
|`Etag: "5a41e638-7ac"`|强|Response|请求返回的id;|
|`Last-Modified:Tue, 26 Dec 2017 06:03:36 GMT`|弱|Response|最后修改时间；|
|`If-None-Match: "5a41e638-7ac"`||Request|用于告诉服务器当前浏览器拥有的资源版本；|
|`If-Modified-Since: Tue, 26 Dec 2017 06:03:36 GMT`||Request||
> **强验证:** 期望的是资源字节级别的一致  
> **弱验证:** 只要资源的主要内容一致即可，允许例如页底的广告，页脚不同

> ### Cache-Control
> * no-cache【强验证】：虽然字面意义是“不要缓存”。但它实际上的机制是，仍然对资源使用缓存，但每一次在使用缓存之前必须（MUST）向服务器对缓存资源进行验证。（实际使用等于no-store）
> * no-store: 不使用任何缓存
> * must-revalidate: `Cache-Control: must-revalidate, max-age=60` 缓存小于max-age使用缓存，不然对资源进行验证
> * max-age=31536000【弱验证】: 缓存最长时间
> * must-revalidate: 重新验证；可搭配max-age做强验证
### If-None-Match运行流程
![](./image/If-None-Match.jpg)
> ### HTTP请求状态码
> 200: 请求已成功，请求所希望的响应头或数据体将随此响应返回。  
> 304: 304 Not Modified浏览器文件内容并未发生修改


## 缓存(Cache-Control)流程示意图
![](./image/Cache-Control.jpg)
## 服务工作线程
:smirk:还没看明白，下面有参考文章。

[参考文章：设计一个无懈可击的浏览器缓存方案：关于思路，细节，ServiceWorker，以及HTTP/2](https://zhuanlan.zhihu.com/p/28113197)  
[参考文章：[MDN]Cache-Control参考](https://developer.mozilla.org/zh-CN/docs/Web/HTTP/Headers/Cache-Control)  
[参考文章：[developers.google.com]服务工作线程：简介](https://developers.google.com/web/fundamentals/primers/service-workers/)