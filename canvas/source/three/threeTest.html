<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <meta http-equiv="X-UA-Compatible" content="ie=edge">
  <title>Three Test</title>
  <style>
    body {
      margin: 0;
    }

    canvas {
      width: 100%;
      height: 100%;
    }
  </style>
</head>
<body>
  <script src="./three.89.js"></script>
  <script src="./OrbitControls.js"></script>
  <script src="./stats.min.js"></script>
  <!-- 顶点着色器 -->
  <script id="vs" type="x-shader/x-vertex">
    //varying从顶点着色器传递到片元着色器中
    varying vec2 vUv;

    void main(){    
      // passing texture to fragment shader
      // uv代表了该顶点在UV映射时的横纵坐标
      vUv = uv;
      gl_Position = projectionMatrix * modelViewMatrix * vec4(position, 1.0);
    }
  </script>
  <!-- 片元着色器 -->
  <script id="fs" type="x-shader/x-fragment">
    varying vec2 vUv;

    void main() {
      gl_FragColor = vec4(vUv.x, vUv.y, 1.0, 1.0);
    }
  </script>
  <script>
    // Our Javascript will go here.
    var scene = new THREE.Scene();
    var camera = new THREE.PerspectiveCamera(40, 1 / 1, 3, 1000);
    var controls = new THREE.OrbitControls( camera );

    var renderer = new THREE.WebGLRenderer();
    // renderer.setSize(500, 500);
    renderer.setSize(window.innerWidth, window.innerHeight);
    //增加阴影配置
    // renderer.shadowMap.enabled = true;
    // renderer.shadowMap.type = THREE.PCFSoftShadowMap;
    document.body.appendChild(renderer.domElement);
    //状态管理器【无视】
    var stats = new Stats();
    stats.showPanel( 1 ); // 0: fps, 1: ms, 2: mb, 3+: custom
    document.body.appendChild( stats.dom );
    //----------形状----------
    // 一个立方体
    var geometry = new THREE.BoxGeometry(2, 2, 2);
    //第二个立方体
    // var geometry = new THREE.CubeGeometry(1, 1, 1);
    // 用三角形拼接一个立体图形
    // var geometry = new THREE.Geometry();
    // geometry.vertices.push(
    //   new THREE.Vector3( -2,  2, 0 ),
    //   new THREE.Vector3( -2, -2, 0 ),
    //   new THREE.Vector3(  2, -2, 0 ),
    //   new THREE.Vector3(  0, 0, -2 ),
    // );
    // // 三角面数组，用来描述模型中的每个顶点是如何相互连接的。
    // geometry.faces.push( 
    //   new THREE.Face3( 0, 1, 2 ),
    //   // new THREE.Face3( 3, 2, 0 ),
    //   new THREE.Face3( 3, 0, 2 ),
    //   new THREE.Face3( 0, 3, 1 ),
    //   new THREE.Face3( 3, 2, 1 ),
    // );
    // geometry.colors = ['red'];
    // geometry.computeBoundingSphere();
    //----------材质----------
    //基本材质
    // var material = new THREE.MeshBasicMaterial({
    //   color: 0xff0000,
    //   // wireframe: true
    // });
    //Lambert材质（漫反射）
    var material = new THREE.MeshLambertMaterial({
      color: 0xffffff,
      // emissive: 'green'
    });
    //着色器材质
    // var material = new THREE.ShaderMaterial({
    //   vertexShader: document.getElementById('vs').textContent,
    //   fragmentShader: document.getElementById('fs').textContent
    // }); 
    //Phong材质（包含镜面反射）
    // var material = new THREE.MeshPhongMaterial({
    //   color: 0xff0000,
    //   // specular: 0xff0000,
    //   shininess: 1000
    // });
    //法向材质
    // var material = new THREE.MeshNormalMaterial()
    //创建模型实体并添加
    var cube = new THREE.Mesh(geometry, material);
    var cube2 = new THREE.Mesh(geometry, material);
    var cube3 = new THREE.Mesh(geometry, material);
    var cube4 = new THREE.Mesh(geometry, material);
    cube.position.set(0, 1, 0);
    cube2.position.set(4, 1, 0);
    cube2.castShadow = true;
    cube3.position.set(8, 1, 0);
    cube4.position.set(-4, 1, 0);
    scene.add(cube, cube2, cube3, cube4);
    //加一个平面
    // var plan = new THREE.PlaneGeometry(20, 20);
    // var cubePlan = new THREE.Mesh(plan, material);
    // cubePlan.rotation.x = -Math.PI / 2;
    // cubePlan.receiveShadow = true;
    // scene.add(cubePlan);
    //网格辅助
    var gridHelperXZ = new THREE.GridHelper( 40, 80, 'white' );
    var gridHelperXY = new THREE.GridHelper( 40, 2, 'white' );
    gridHelperXY.rotation.x = Math.PI/2;
    var gridHelperYZ = new THREE.GridHelper( 40, 2, 'white' );
    gridHelperYZ.rotation.z = Math.PI/2;
    scene.add( gridHelperXZ, gridHelperXY, gridHelperYZ );
    //----------上帝说要有光----------
    //点光源
    // var light = new THREE.PointLight( 0xff0040, 1, 50 );
    // light.position.set( 3, 3, 0 );
    // scene.add( light );
    // var PI2 = Math.PI * 2;
    // var program = function ( context ) {
    //   context.beginPath();
    //   context.arc( 0, 0, 0.5, 0, PI2, true );
    //   context.fill();
    // };
    // var sprite = new THREE.Sprite( new THREE.SpriteCanvasMaterial( { color: 0xff0040, program: program } ) );
    // light1.add( sprite );
    //环境光
    // var light = new THREE.AmbientLight('white');
    // scene.add(light);
    //点光源
    // var light = new THREE.PointLight(0xffffff, 2, 40);
    // light.position.set(0, 0, 3);
    // scene.add(light);
    //平行光
    // var light = new THREE.DirectionalLight();
    // light.position.z = 4;
    // scene.add(light);
    //聚光灯
    var light = new THREE.SpotLight(0xffffff, 5, 100, Math.PI / 4, 25);
    light.position.set(0, 5, 0);
    // light.target = cube2;
    light.castShadow = true;
    scene.add(light);
    //阴影辅助
    // var helper = new THREE.CameraHelper( light.shadow.camera );
    // scene.add( helper );
    //阴影


    //旋转个可视角度
    // scene.rotation.y = -Math.PI / 4;
    // scene.rotation.x = Math.PI / 4;
    // camera.position.x = 10;
    // camera.position.y = 10;
    camera.position.z = 50;
    // ----------动画----------
    var render = function () {
      stats.begin();
      // var time = Date.now() * 0.0005;
      // cube.rotation.x += 0.005;
      // cube.rotation.y += 0.02;
      // cube.position.z += 0.02;

      // scene.rotation.x += 0.02;
      // scene.rotation.y += 0.005;
      // light.position.x = Math.sin( time * 0.7 ) * 30;
      // light.position.y = Math.cos( time * 0.5 ) * 40;
      // light.position.z = Math.cos( time * 0.3 ) * 30;
      // controls.update();
      renderer.render(scene, camera);
      stats.end();
      requestAnimationFrame(render);
    };
    render();
  </script>
</body>

</html>